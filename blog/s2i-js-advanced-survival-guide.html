<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Fabio Mancin's Contacts - Full Stack Web Developer</title>
  <meta name="description"
    content="Fabio Mancin's Contact Page. Contact Fabio, self-taught Full Stack Web Developer. Contact me via Social Media or via email!">
  <meta name="author" content="Fabio Mancin">
  <meta name="title" content="Fabio Mancin's Contact Page - Full Stack Web Developer">
  <meta property="og:title" content="Fabio Mancin's Contact Page">
  <meta property="og:description" content="Fabio Mancin's Contact Page - Full Stack Web Developer">
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://www.fabiomancin.dev/index.html">
  <meta property="og:image" content="/static/img/fabio.webp">
  <meta property="og:site_name" content="Fabio Mancin">
  <meta name="twitter:title" content="Fabio Mancin's Contact Page">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@fabiomancin">
  <meta name="twitter:description"
    content="Fabio Mancin's Contact Page. Contact Fabio, self-taught Full Stack Web Developer. Contact me via Social Media or via email!">
  <meta name="twitter:image" content="/static/img/fabio.webp">
  <meta property="article:author" content="https://www.fabiomancin.dev/index.html">
  <meta property="fb:app_id" content="1362434663" />
  <link rel="shortcut icon" type="image/webp" href="/static/img/vader.webp">
  <link rel="preconnect" href="https://fonts.g/static.com" crossorigin />
  <link rel="stylesheet" href="/static/styles/github-markdown.min.css" >
  <link rel="stylesheet" href="/static/styles/a11y-dark.min.css">
  <link rel="stylesheet" href="/static/styles/styles.min.css">
  <link rel="stylesheet" href="/static/styles/blog_article.min.css">
</head>

<body>
  <div class="decoration top">&lt;html&gt;<br> &nbsp;&lt;body&gt;</div>
  <a href="/index.html" class="home">
    <section>
      <span class="home-text"> HOME </span>
      <div class="home-img-container">
        <img src="/static/img/home.svg" alt="Home Logo" />
      </div>
    </section>
  </a>
  <nav>
    <div class="decoration mid-top">&lt;nav&gt;</div>
    <ul>
      <li>
        <span class="menu-text">MENU</span>
        <img src="/static/img/menu.svg" alt="Menu Logo" width="24" height="24" />
      </li>
      <a href="/about.html">
        <li class="dropdown-nav hidden">
          <span class="menu-text">ABOUT</span>
          <img src="/static/img/coffee.svg" alt="About Logo" width="24" height="24" />
        </li>
      </a>
      <a href="/projects.html">
        <li class="dropdown-nav hidden">
          <span class="menu-text">PROJECTS</span>
          <img src="/static/img/archive.svg" alt="Projects Logo" width="24" height="24" />
        </li>
      </a>
      <a href="/skills.html">
        <li class="dropdown-nav hidden">
          <span class="menu-text">SKILLS</span>
          <img src="/static/img/briefcase.svg" alt="Skills Logo" width="24" height="24" />
        </li>
      </a>
      <a href="/blog.html">
        <li class="dropdown-nav hidden">
          <span class="menu-text">BLOG</span>
          <img src="/static/img/hash.svg" alt="Skills Logo" width="24" height="24" />
        </li>
      </a>
      <a href="/contacts.html">
        <li class="dropdown-nav hidden">
          <span class="menu-text">CONTACTS</span>
          <img src="/static/img/at-sign.svg" alt="Contacts Logo" width="24" height="24" />
        </li>
      </a>
    </ul>
  </nav>

  <main class="blog markdown-body">
    <h1 id="start2impact-javascript-advanced-project-survival-guide">Start2Impact: Javascript Advanced Project Survival
      Guide</h1>
    <h2 id="disclaimer">Disclaimer</h2>
    <p>Non moster√≤ intenzionalmente ogni singola riga di codice necessaria a svolgere il progetto: lo sviluppo software
      √© fatto in buona parte di <strong>ricerca, studio e processo di trial and error.</strong></p>
    <p>Suggerisco di non copiare ed incollare il codice fornito senza guardarlo: s√¨, pu√≤ funzionare, ma non si impara
      nulla. Anzi se qualcosa non vi √® chiaro andate subito su Google e troverete decine di risorse per approfondire
      quell&#39;argomento!</p>
    <p>C&#39;√® un muro davvero alto fra la semplicit√† dei tre file HTML, CSS e JS ed il mondo di versionamento,
      variabili d&#39;ambiente, bundlers, deployment.</p>
    <p>Ho scritto questa guida per facilitare la fase di preparazione che sta fra lo studio della Super Guida e lo
      svolgimento pratico del progetto riunendo le nozioni di base che ho visto creavano pi√π dubbi (Node, Git, WebPack,
      Environment Variables, Netlify) in modo ordinato ed estremamente semplificato, in quanto la documentazione
      ufficiale di quegli strumenti √® cos√¨ vasta che diventa ostica da approcciare per chi si sta avvicinando soltanto
      ora al mondo della programmazione; ci√≤ nonostante questa non vuole diventare una scusa per non studiare: invito
      tutti ad approfondire il pi√π possibile gli argomenti e cercare di capire tutto ci√≤ che si fa.</p>
    <p><strong>I FILE CONTENUTI IN <a href="https://github.com/fabio-mancin/s2i-js-advanced-survival-guide">QUESTO REPOSITORY</a> SONO QUELLI CHE SPIEGO NELLA GUIDA!</strong></p>
    <p>Un&#39;ultima nota prima di iniziare: troverete errori ed imprecisioni e conto su di voi e sul vostro feedback
      per la correzione; inoltre esistono sicuramente modi migliori per arrivare allo stesso risultato finale, ma con le
      mie limitatissime conoscenze attuali questo √® il meglio che riesco a fare. Sono apertissimo ad imparare cose
      nuove, quindi se qualcuno ha idee me lo dica! I miei contatti sono in fondo alla guida.</p>
    <hr>
    <h2 id="table-of-contents">Table of contents</h2>
    <ul>
      <li><a href="#start2impact-javascript-advanced-project-survival-guide">Start2Impact: Javascript Advanced Project
          Survival Guide</a>
        <ul>
          <li><a href="#disclaimer">Disclaimer</a></li>
          <li><a href="#table-of-contents">Table of contents</a></li>
          <li><a href="#prerequisiti">Prerequisiti</a></li>
          <li><a href="#temi">Temi</a>
            <ul>
              <li><a href="#webpack">WebPack</a></li>
              <li><a href="#environment-variables">Environment Variables</a></li>
              <li><a href="#api-e-chiamate-asincrone">API e chiamate asincrone</a></li>
              <li><a href="#deployment">Deployment</a></li>
            </ul>
          </li>
          <li><a href="#configurazione-iniziale">Configurazione iniziale</a></li>
          <li><a href="#ambienti-di-sviluppo">Ambienti di sviluppo</a>
            <ul>
              <li><a href="#webpackconfigjs">webpack.config.js</a></li>
              <li><a href="#packagejson">package.json</a></li>
            </ul>
          </li>
          <li><a href="#chiamata-alle-api">Chiamata alle API</a></li>
          <li><a href="#environment-variables-to-the-rescue">Environment Variables to the rescue</a></li>
          <li><a href="#javascript-ha-fretta">JavaScript ha fretta</a></li>
          <li><a href="#live-demo-dilemma">Live demo dilemma</a></li>
          <li><a href="#that-s-all-folks">That&#39;s all folks</a></li>
        </ul>
      </li>
    </ul>
    <h2 id="prerequisiti">Prerequisiti</h2>
    <ul>
      <li><a href="https://github.com/">Account su GitHub</a>
        <ul>
          <li>Abbiamo bisogno di GitHub per mostrare il codice sorgente ed utilizzare il continuous deployment di
            Netlify.</li>
        </ul>
      </li>
      <li><a href="https://github.com/cli/cli">GitHub CLI</a>
        <ul>
          <li>In alternativa <a href="https://desktop.github.com/">GitHub Desktop</a>. Io user√≤ la CLI nella guida.</li>
        </ul>
      </li>
      <li><a href="https://nodejs.org/en/">NodeJS</a>
        <ul>
          <li>Node ci permette di avere accesso ad <a href="https://npmjs.com/">NPM</a> ed agli script necessari al
            development e deployment.</li>
        </ul>
      </li>
      <li><a href="https://netlify.com">Account su Netlify</a>
        <ul>
          <li>Useremo Netlify per deployare il progetto; si pu√≤ fare anche con altre piattaforme (ad esempio Firebase)
            ma il processo sar√† differente. Su Netlify tutte le funzionalit√† che utilizzeremo sono disponibili
            <strong>gratuitamente</strong>.</li>
        </ul>
      </li>
    </ul>
    <hr>
    <h2 id="temi">Temi</h2>
    <h3 id="webpack">WebPack</h3>
    <blockquote>
      <p>WebPack √® un bundler: un software che prende i file che vengono creati e le librerie che vengono utilizzate, ne
        ottimizza il codice e riunisce il tutto in un solo file che si pu√≤ mettere online. Nella pratica noi creeremo un
        file <em>index.js</em> che dipender√† anche da librerie esterne (axios, lodash); quello che verr√† messo online
        nella demo, per√≤, sar√† un unico file <em>bundle.js</em> che contiene tutto quanto. Ci permette anche di usare
        configurazioni diverse in base alla necessit√†: se stiamo sviluppando e facendo test useremo una configurazione,
        mentre per la versione finale che verr√† messa online ne useremo un&#39;altra.
        Per una guida pi√π estensiva di WebPack vi rimando a quella di <code>@pablomicheletti#6410</code>, pubblicata su
        Discord!</p>
    </blockquote>
    <h3 id="environment-variables">Environment Variables</h3>
    <blockquote>
      <p>Nel progetto √® richiesto di utilizzare una chiave API, cio√® un token univoco che permette di accedere ai dati
        del server. Queste chiavi sono private ed assolutamente da tenere nascoste: non si possono pubblicare su GitHub
        n√® lasciare che traspaiano dalla demo del sito che metteremo online.
        Per farlo in locale useremo una libreria chiamata <strong>webpack-dotenv</strong>, mentre per la demo ci
        affideremo a delle particolari funzioni messe a disposizione da Netlify.</p>
    </blockquote>
    <h3 id="api-e-chiamate-asincrone">API e chiamate asincrone</h3>
    <blockquote>
      <p>JavaScript ha fretta: non aspetta che una funzione abbia finito di fare il suo dovere prima di eseguire quella
        successiva, quindi se la seconda dipende dal risultato della prima l&#39;applicazione non funziona. Esempio:
        funzione A si aspetta una serie di dati, quindi li va a cercare; funzione B utilizza quei dati ma non aspetta
        che A abbia finito di cercare, quindi usa una variabile vuota.. Non riuscendo a far nulla. Dobbiamo imparare a
        far star tranquillo JS con funzioni chiamate asincrone, cio√® che aspettano qualcosa prima di continuare.
        <strong>Axios</strong> √® una libreria che ci aiuter√† ad eseguire le chiamate a risorse esterne con scioltezza.
      </p>
    </blockquote>
    <h3 id="deployment">Deployment</h3>
    <blockquote>
      <p>Nel progetto √® richiesta una live demo: impareremo a crearne una su Netlify.</p>
      <hr>
    </blockquote>
    <h2 id="configurazione-iniziale">Configurazione iniziale</h2>
    <p>Per prima cosa dritti su GitHub a creare un repository dal menu in alto a destra.</p>
    <p><img src="assets/newrepo.webp" alt="Creazione Repository"></p>
    <ul>
      <li>Nome a piacere</li>
      <li>Descrizione opzionale ma consigliata</li>
      <li>Per il momento repository privato, a fine progetto verr√† cambiato in pubblico</li>
      <li>Aggiungere README ‚úÖ</li>
      <li>Aggiungere gitignore con template Node‚úÖ</li>
      <li>Licenza MIT ‚úÖ</li>
    </ul>
    <p><img src="assets/newrepo1.webp" alt="Configurazione Repository"></p>
    <p>Andate nella cartella dove volete inizializzare il progetto ed aprite una CLI in quella posizione.</p>
    <ul>
      <li><code>gh auth login</code>
        <ul>
          <li>Per loggarsi con il proprio profilo GitHub permettendo l&#39;accesso ai repository</li>
        </ul>
      </li>
      <li><code>gh repo clone nome-utente/nome-repository</code>
        <ul>
          <li>Per scaricare i file creati da GitHub durante la configurazione del repo e poterli usare in locale</li>
        </ul>
      </li>
      <li><code>cd nome-repository</code>
        <ul>
          <li>Per spostarsi nella cartella appena creata</li>
        </ul>
      </li>
      <li><code>npm init</code>
        <ul>
          <li>Procedura guidata che creer√† un file package.json, che servir√† a Node per gestire i moduli del progetto e
            gli script che verranno utilizzati da WebPack.</li>
        </ul>
      </li>
      <li><code>npm install webpack webpack-cli dotenv-webpack html-webpack-plugin webpack-dev-server --save-dev</code>
        <ul>
          <li>NPM installer√† i moduli che ci servono durante lo sviluppo (notare il comando <em>--save-dev</em> alla
            fine della riga)</li>
        </ul>
      </li>
      <li><code>npm install axios</code>
        <ul>
          <li>NPM installer√† axios che verr√† utilizzato anche in fase di produzione</li>
        </ul>
      </li>
    </ul>
    <p><img src="assets/npminit.webp" alt="Configurazione NPM"></p>
    <p>Successivamente creeremo delle cartelle e file che useremo pi√π tardi: fatelo subito e ne spiegher√≤ l&#39;uso
      quando diverranno necessari.
      I file da creare sono i seguenti (li riempiremo pi√π tardi):</p>
    <ul>
      <li><code>getPollution.js</code> dentro a <code>netlify/functions</code></li>
      <li><code>index.js</code>, <code>index_dev.js</code> e <code>index.html</code> in <code>src</code></li>
      <li><code>.env</code></li>
      <li><code>.env.example</code></li>
      <li><code>netlify.toml</code></li>
    </ul>
    <p>Nel file <code>index.html</code> mettiamo una struttura di base HTML5:</p>
    <pre><code class="lang-html"><span class="xml"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span> /&gt;</span>
    <span class="hljs-comment">&lt;!-- Con questa riga htmlWebpackPlugin sostituisce il titolo del file con quello specificato in webpack.config.js - lo faremo fra poco! --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> htmlWebpackPlugin.options.title </span><span class="xml"><span class="hljs-tag">%&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- Questo √® un placeholder per favicon.ico, ricordate di metterne uno decente prima di inviare il progetto :P --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span>
      <span class="hljs-attr">href</span>=<span class="hljs-string">"data:image/x-icon;base64,AAABAAEAEBAQAAEABAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAA/4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAERERERERERERAAAAAAAAERAQAAAAAAEBEAEAAAAAEAEQABAAAAEAARAAAQAAEAABEAAAEAEAAAEQAAABEAAAARAAAAEQAAABEAAAEAEAAAEQAAEAABAAARAAEAAAAQABEAEAAAAAEAEQEAAAAAABAREAAAAAAAAREREREREREREAAAAAP/wAAF/6AABv9gAAd+4AAHveAAB9vgAAfn4AAH5+AAB9vgAAe94AAHfuAABv9gAAX/oAAD/8AAAAAAAA"</span>
      <span class="hljs-attr">rel</span>=<span class="hljs-string">"icon"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"image/x-icon"</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"wrapper"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span>
</code></pre>
    <p>A fine procedimento la struttura della cartella sar√† la seguente: </p>
    <p>üì¶repository-name<br> ‚î£ üìÇ.<strong><em>git</em></strong><br> ‚îÉ ‚î£ <strong><em>[...]</em></strong><br> ‚î£ üìÇnetlify
      &lt;&gt;<br> ‚îÉ ‚î£ üìÇfunctions &lt;&gt;<br> ‚îÉ ‚îÉ ‚î£ üìúgetPollution.js &lt;&gt;<br> ‚î£
      üìÇ<strong><em>node_modules</em></strong><br> ‚îÉ ‚î£ <strong><em>[...]</em></strong><br> ‚î£ üìÇsrc &lt;&gt;<br> ‚îÉ ‚î£
      üìúindex.html &lt;&gt;<br> ‚îÉ ‚î£ üìúindex.js &lt;&gt;<br> ‚îÉ ‚îó üìúindex_dev.js &lt;&gt;<br> ‚î£ üìú.env &lt;&gt;<br> ‚î£
      üìú.env.example &lt;&gt;<br> ‚î£ üìú.<strong><em>gitignore</em></strong><br> ‚î£ üìú<strong><em>LICENSE</em></strong><br>
      ‚î£ üìúnetlify.toml &lt;&gt;<br> ‚î£ üìú<strong><em>package-lock.json</em></strong><br> ‚î£
      üìú<strong><em>package.json</em></strong><br> ‚î£ üìú<strong><em>README.md</em></strong><br> ‚îó üìúwebpack.config.js
      &lt;&gt;</p>
    <p><em>File e cartelle in **</em>grassetto<strong>* vengono generati automaticamente e quindi </strong>per ora<em>*
        non vanno toccati!</em></p>
    <p><em>Quelli contrassegnati da &lt;&gt; finale invece vanno creati ora.</em></p>
    <hr>
    <h2 id="ambienti-di-sviluppo">Ambienti di sviluppo</h2>
    <p>Come anticipato, dovremo usare una configurazione per la fase di sviluppo (<em>development</em>) ed un&#39;altra
      per la fase di produzione (<em>production</em>).</p>
    <p>WebPack, propriamente configurato, ci aiuter√† in questo compito.<br><strong>Prestate attenzione ai commenti,
        spiegano cosa sta succedendo!</strong><br>Nel file <code>webpack.config.js</code> che abbiamo appena creato
      nella cartella principale del progetto, la stessa di <code>package.json</code>, scriviamo: </p>
    <h3 id="webpack-config-js">webpack.config.js</h3>
    <pre><code class="lang-javascript">  <span class="hljs-comment">// Plugin che ci permette di utilizzare un template nel codice sorgente e ottimizzarlo per la versione che andr√† online</span>
  <span class="hljs-keyword">const</span> HtmlWebpackPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">"html-webpack-plugin"</span>)
  <span class="hljs-comment">// Libreria che ci permette di utilizzare le Environment Variables durante lo sviluppo locale</span>
  <span class="hljs-keyword">const</span> Dotenv = <span class="hljs-built_in">require</span>(<span class="hljs-string">'dotenv-webpack'</span>)
  <span class="hljs-comment">// Modulo di NodeJS che d√† la possibilit√† di interagire con file e cartelle locali</span>
  <span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>)

  <span class="hljs-comment">// Per permettere a WebPack di utilizzare gli argomenti il modulo deve essere una funzione (normalmente √® un oggetto)</span>
  <span class="hljs-built_in">module</span>.exports = <span class="hljs-function">(<span class="hljs-params">env, argv</span>) =&gt;</span> {
    <span class="hljs-comment">// FONDAMENTALE! Definiamo il file da utilizzare in base all'ambiente</span>
    <span class="hljs-comment">// Se WebPack vede che siamo in sviluppo andr√† ad utilizzare './src/index_dev.js'</span>
    <span class="hljs-comment">// Se invece saremo in produzione utilizzer√† './src/index.js'</span>
    <span class="hljs-keyword">const</span> entryPath = argv.mode === <span class="hljs-string">'development'</span> ? <span class="hljs-string">'./src/index_dev.js'</span> : <span class="hljs-string">'./src/index.js'</span>
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">entry</span>: {
        <span class="hljs-comment">// Qui specifichiamo il file di ENTRATA, vedi commento sopra</span>
        main: path.resolve(__dirname, entryPath),
      },
      <span class="hljs-attr">output</span>: {
        <span class="hljs-comment">// Una volta creato un pacchetto WebPack metter√† i file risultanti nella cartella build</span>
        filename: <span class="hljs-string">'[name].bundle.js'</span>,
        <span class="hljs-attr">path</span>: path.resolve(__dirname, <span class="hljs-string">'build'</span>)
      },
      <span class="hljs-comment">// Configurazione di un plugin, necessario per sveltire il processo di sviluppo vedi asterischi nello snippet successivo **</span>
      devServer: {
        <span class="hljs-attr">contentBase</span>: <span class="hljs-string">'./build'</span>,
        <span class="hljs-attr">open</span>: <span class="hljs-literal">true</span>
      },
      <span class="hljs-attr">plugins</span>: [
        <span class="hljs-comment">// Plugin che prende un template e lo personalizza, completandolo con scripts ed eventuali stili</span>
        <span class="hljs-keyword">new</span> HtmlWebpackPlugin({
          <span class="hljs-attr">title</span>: <span class="hljs-string">"Pollution Forecast"</span>,
          <span class="hljs-attr">template</span>: path.resolve(__dirname, <span class="hljs-string">'./src/index.html'</span>),
        }),
        <span class="hljs-comment">// Qui dotenv-webpack viene inizializzato</span>
        <span class="hljs-keyword">new</span> Dotenv()
      ]
    }
};
</code></pre>
    <h3 id="package-json">package.json</h3>
    <p>Successivamente configuriamo Node dal file <code>package.json</code> per eseguire alcuni script necessari: la
      maggioranza del file √® stata generata automaticamente quando abbiamo eseguito <code>npm init</code>; la parte
      commentata mostra cosa dobbiamo cambiare:</p>
    <pre><code class="lang-javascript">{
  <span class="hljs-string">"name"</span>: <span class="hljs-string">"s2i-js-advanced-survival-guide"</span>,
  <span class="hljs-string">"version"</span>: <span class="hljs-string">"1.0.0"</span>,
  <span class="hljs-string">"description"</span>: <span class="hljs-string">"S2I JS Advanced Project"</span>,
  <span class="hljs-string">"main"</span>: <span class="hljs-string">"index.js"</span>,
  <span class="hljs-comment">// La sezione scripts va modificata per usare le funzionalit√† di webpack</span>
  <span class="hljs-string">"scripts"</span>: {
    <span class="hljs-string">"test"</span>: <span class="hljs-string">"echo \"</span><span class="hljs-keyword">Error</span>: <span class="hljs-keyword">no</span> <span class="hljs-keyword">test</span> specified\<span class="hljs-string">" &amp;&amp; exit 1"</span>,
    <span class="hljs-comment">// Quando viene lanciato il comando npm run dev webpack fa partire il plugin dev server in modalit√† sviluppo</span>
    <span class="hljs-comment">// vedi commento nello snippet sopra **</span>
    <span class="hljs-string">"dev"</span>: <span class="hljs-string">"webpack serve --mode development"</span>,
    <span class="hljs-comment">// Mentre in modalit√† produzione viene ottimizzato e impacchettato il codice</span>
    <span class="hljs-string">"build"</span>: <span class="hljs-string">"webpack --mode production"</span>
  },
  <span class="hljs-string">"repository"</span>: {
    <span class="hljs-string">"type"</span>: <span class="hljs-string">"git"</span>,
    <span class="hljs-string">"url"</span>: <span class="hljs-string">"git+https://github.com/fabio-mancin/s2i-js-advanced-survival-guide.git"</span>
  },
  <span class="hljs-string">"author"</span>: <span class="hljs-string">""</span>,
  <span class="hljs-string">"license"</span>: <span class="hljs-string">"MIT"</span>,
  <span class="hljs-string">"bugs"</span>: {
    <span class="hljs-string">"url"</span>: <span class="hljs-string">"https://github.com/fabio-mancin/s2i-js-advanced-survival-guide/issues"</span>
  },
  <span class="hljs-string">"homepage"</span>: <span class="hljs-string">"https://github.com/fabio-mancin/s2i-js-advanced-survival-guide#readme"</span>,
  <span class="hljs-string">"devDependencies"</span>: {
    <span class="hljs-string">"dotenv-webpack"</span>: <span class="hljs-string">"^7.0.2"</span>,
    <span class="hljs-string">"html-webpack-plugin"</span>: <span class="hljs-string">"^5.3.1"</span>,
    <span class="hljs-string">"webpack"</span>: <span class="hljs-string">"^5.26.3"</span>,
    <span class="hljs-string">"webpack-cli"</span>: <span class="hljs-string">"^4.5.0"</span>,
    <span class="hljs-string">"webpack-dev-server"</span>: <span class="hljs-string">"^3.11.2"</span>
  },
  <span class="hljs-string">"dependencies"</span>: {
    <span class="hljs-string">"axios"</span>: <span class="hljs-string">"^0.21.1"</span>
  }
}
</code></pre>
    <p><strong>La prima parte √® andata!</strong>
      Ora abbiamo due modalit√† disponibili - sviluppo e produzione! Da riga di comando:</p>
    <ul>
      <li>
        <p><code>npm run dev</code></p>
        <ul>
          <li>Fa partire un Live Server nel browser che si aggiorna ad ogni cambiamento che facciamo nei file, perfetto
            per lo sviluppo!</li>
          <li>In questa modalit√† viene utilizzato il file <code>index_dev.js</code>. Provate a scriverci dentro lo
            snippet sotto e vedrete il browser aggiornarsi e far partire un fastidiosissimo alert ed un messaggio nella
            console.</li>
        </ul>
        <pre><code class="lang-javascript"><span class="hljs-comment">// index_dev.js</span>

<span class="hljs-function"><span class="hljs-title">alert</span><span class="hljs-params">(<span class="hljs-string">'Ora sembra tutto un casino ma alla fine sar√† pi√π chiaro.. spero!'</span>)</span></span>
console.info(<span class="hljs-string">'Va bene Fabio, se lo dici tu..'</span>)
</code></pre>
      </li>
      <li>
        <p><code>npm run build</code></p>
        <ul>
          <li>Crea un bundle e lo piazza in <code>/build</code>.</li>
          <li>Questa parte la far√† principalmente Netlify, in quanto lo istruiremo pi√π tardi per eseguire quel comando e
            poi mettere online il contenuto di quella cartella.</li>
        </ul>
      </li>
    </ul>
    <hr>
    <h2 id="chiamata-alle-api">Chiamata alle API</h2>
    <p>Ora le cose si fanno pi√π interessanti e &#39;tangibili&#39;.</p>
    <p>Le <strong>Application Programming Interfaces</strong> spiegate nei termini pi√π terra-terra possibili sono dei
      metodi messi a disposizione da qualcuno (nel nostro caso un ente internazionale di controllo dell&#39;inquinamento
      dell&#39;aria) per dare accesso ai propri dati. </p>
    <p>Alcune API sono interamente libere (ad esempio <a href="https://swapi.dev/">Star Wars API</a>) ed ottime per fare
      pratica; alcune hanno un modello su abbonamento (<a href="https://www.flightapi.io/">Flight API</a>) in cui pi√π si
      paga pi√π frequentemente si possono richiedere dati o si ha accesso a dati ulteriori; altre ancora, come quella che
      useremo noi, sono di libero accesso ma limitano il numero di richieste inviabili dallo stesso client per evitare
      abusi e congestioni.</p>
    <p>La maggioranza comunque fornisce una chiave, la famigerata API KEY, che permette di identificare il richiedente
      ed applicare eventuali limitazioni o privilegi. La chiave che andremo a richiedere noi √® gratuita quindi nel caso
      venisse diffusa non ci sarebbero chiss√† che problemi, ma questi progetti sono fatti apposta per imparare senza
      &quot;rischi&quot; a gestire situazioni reali, quindi impareremo prima ad usare la chiave in locale e poi come
      utilizzarla in un sito reale senza diffonderla.</p>
    <p>Prima di tutto la chiave va richiesta da <a href="https://aqicn.org/data-platform/token/#/">questa pagina di
        AQICN</a>; arriver√† via mail una stringa di numeri e lettere. La utilizzeremo poi per ottenere i dati dai server
      di AQICN.</p>
    <p>La prima e giusta idea che salta alla mente sarebbe semplicemente di piazzare la chiave in una variabile ed
      utilizzarla, tipo</p>
    <pre><code class="lang-javascript"><span class="hljs-keyword">const</span> API_KEY = <span class="hljs-string">"stringaDiNumeriELettere"</span>
<span class="hljs-comment">// fare cose con API_KEY</span>
console.<span class="hljs-built_in">log</span>(API_KEY)
</code></pre>
    <p>funziona perfettamente, ma questo esporrebbe la chiave in due modi:</p>
    <ul>
      <li>Su GitHub, dato che il codice sorgente andr√† messo pubblicamente online in modo che il coach (ed un eventuale
        datore di lavoro in futuro!) possano valutarlo.</li>
      <li>Anche dopo aver impacchettato il file con WebPack (<code>npm run build</code>) la chiave sarebbe visibile nel
        bundle .js! Per quanto il file sia stato minificato (e quindi di difficile lettura per un umano), qualsiasi bot
        basilare potrebbe parsare quel file in centesimi di secondo e rubare la chiave; inoltre esistono script che
        fanno il processo di minificazione al contrario, quindi fanno tornare leggibili file minificati. Insomma,
        <strong>IL BUNDLE NON E&#39; ASSOLUTAMENTE UN MODO PER NASCONDERE I DATI SENSIBILI, E NON E&#39; PENSATO PER
          ESSERLO!</strong></li>
      <li>Nella versione live del sito, semplicemente dai Dev Tool tramite i quali si possono ispezionare tutti i file
        che compongono un sito e le richieste che arrivano da esso.</li>
    </ul>
    <p>Per fortuna abbiamo gli strumenti (e la guida :P) per gestire questo problema!</p>
    <hr>
    <h2 id="environment-variables-to-the-rescue">Environment Variables to the rescue</h2>
    <p>Nasconderemo la key nell&#39;ambiente di sviluppo stesso.
      Date un&#39;occhiata al file <code>.gitignore</code>: √® stato pregenerato da GitHub quando abbiamo inizializzato
      il repository, e consiste in una lista di regole che dicono a GitHub: &quot;Quando pubblicherai questo progetto
      <em>SALTA</em> questi tipi di file/cartelle, sono privati!&quot;.</p>
    <p>Fra di essi, scorrendo, vedrete scritto <code>.env</code>: il file dove inseriremo la nostra key e che non verr√†
      messo online pi√π tardi per salvarla.</p>
    <p>Gi√† che siamo qui, aggiungiamo a fine file la riga</p>
    <pre><code class="lang-javascript"><span class="hljs-title">.netlify/</span>
</code></pre>
    <p>..non sono necessarie ma √® una misura di sicurezza aggiuntiva. Sono un po&#39; paranoico.</p>
    <p>Chiudiamo <code>.gitignore</code> ed apriamo <code>.env</code>, al cui interno andremo a scrivere
      soltanto:<br><code>API_KEY = inserireLaVostraApiKeyQui</code></p>
    <p>Ora la magia fatta dal plugin <code>webpack-dotenv</code>: in <code>webpack.config.js</code> abbiamo dichiarato
    </p>
    <pre><code class="lang-javascript"><span class="hljs-comment">// ...</span>
<span class="hljs-string">plugins:</span> [
        <span class="hljs-comment">// ...</span>
        <span class="hljs-comment">// Qui dotenv-webpack viene inizializzato</span>
        <span class="hljs-keyword">new</span> Dotenv()
      ]
<span class="hljs-comment">// ...</span>
</code></pre>
    <p>Quella semplice riga mette a disposizione la variabile che si trova in <code>.env</code> in tutta
      l&#39;applicazione come variabile d&#39;ambiente a cui si accede molto semplicemente..</p>
    <pre><code class="lang-javascript"><span class="hljs-comment">// ..cos√¨!</span>
const API_KEY = process<span class="hljs-selector-class">.env</span><span class="hljs-selector-class">.API_KEY</span>
</code></pre>
    <p>Quindi quando qualcuno (il coach!) scaricher√† il vostro codice sorgente per provarlo, semplicemente andr√† ad
      inserire la sua personale chiave nel file <code>.env</code> e la nostra configurazione la sostituir√† dove
      necessario per provare l&#39;applicazione.</p>
    <p>Ricordate di scrivere le istruzioni nel file README che creerete!</p>
    <p>E&#39; buona prassi scrivere la traccia di <code>.env</code> in <code>.env.example</code>: aprite
      quest&#39;ultimo e scriveteci soltanto <code>API_KEY = inserireChiaveQui</code>; successivamente nel README
      scriverete qualcosa tipo.. </p>
    <blockquote>
      <p>Sostituire la chiave personale in <code>.env.example</code> e rinominarlo in <code>.env</code> per iniziare a
        testare l&#39;applicazione.</p>
    </blockquote>
    <hr>
    <h2 id="javascript-ha-fretta">JavaScript ha fretta</h2>
    <p>Un&#39;altra sezione divertente, e qui ci sporchiamo le mani: la chiamata alla API.<br>Abbiamo una chiave e non
      abbiamo (o non avremo, dopo questa guida!) paura di usarla.</p>
    <p>Il concetto fondamentale qui, come anticipato ad inizio guida, √® che JS funziona in modo
      <strong>SINCRONO</strong>: il browser legge lo script ed esegue tutto ci√≤ che trova riga per riga pi√π velocemente
      possibile. </p>
    <p>Se pu√≤ essere utile fatemi sapere e scriver√≤ una guida sulla sincronia, mentre in questa mi limiter√≤ ai concetti
      fondamentali: la chiamata alla API, per quanto veloce (richiediamo e riceviamo pochissimi dati, questione di 1
      secondo) non √® immediata, quindi dobbiamo a dire a JavaScript: <strong>richiedi questi dati e POI, una volta
        arrivati e validati, facci qualcosa</strong>.</p>
    <p>Per farlo dobbiamo incapsulare la richiesta in una funzione detta <strong>ASINCRONA</strong> che inseriremo in
      <code>src/index_dev.js</code>:</p>
    <pre><code class="lang-javascript"><span class="hljs-comment">// importiamo una libreria che abbellisce e semplifica la sintassi della richiesta</span>
<span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">"axios"</span>

<span class="hljs-comment">// le funzioni asincrone si dichiarano aggiungendo async prima dell'espressione</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">requestPollutionData</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// la nostra chiave √® al sicuro nelle Environment Variables</span>
  <span class="hljs-keyword">const</span> API_KEY = process.env.API_KEY

  <span class="hljs-comment">// la parola chiave √® await: √® quella che dice a JS di fermarsi a questa riga finch√® axios non restituisce il risultato della richiesta</span>
  <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> axios.get(<span class="hljs-string">`/* ... */<span class="hljs-subst">${API_KEY}</span>`</span>) <span class="hljs-comment">// non scriver√≤ COME fare la richiesta, va capito dalla documentazione https://aqicn.org/json-api/doc/</span>

  <span class="hljs-built_in">console</span>.log(result) <span class="hljs-comment">// facciamo ci√≤ che vogliamo con i dati ottenuti: scelta, elaborazione, visualizzazione..</span>
}

requestPollutionData() 
<span class="hljs-comment">// sarebbe meglio una IIFE: https://developer.mozilla.org/en-US/docs/Glossary/IIFE - non l'ho usata per rendere pi√π chiaro il codice</span>
</code></pre>
    <p>La parte del codice sorgente di base √® finita: potremmo pushare il nostro repository su GitHub e chiunque
      potrebbe scaricarne una copia, sostitiure la propria key personale in <code>.env</code> ed iniziare a lavorarci.
    </p>
    <p>Nel progetto viene per√≤ richiesto un ulteriore passaggio, cio√® la possibilit√† di vedere una demo online
      dell&#39;applicazione.</p>
    <hr>
    <h2 id="live-demo-dilemma">Live demo dilemma</h2>
    <p>Il problema √® che stiamo lavorando in locale: una volta deployata l&#39;applicazione su Netlify la piattaforma
      non avr√† accesso al file <code>.env</code> perch√® l&#39;abbiamo nascosto da GitHub, e quindi non sapr√† da dove
      andare a pescare la api key.</p>
    <p>Nei siti &quot;reali&quot; le chiavi sono fornite da un back-end, cio√® un server che elabora i dati per poi
      passarli al front-end per essere visualizzati, ma noi non abbiamo un back-end!</p>
    <p>Per fortuna gli ingegneri di Netlify (santi subito pls) hanno messo a disposizione alcuni strumenti per ovviare
      al problema: variabili d&#39;ambiente interne a Netlify e funzioni lambda per andare a pescare quelle variabili
      senza esporle.</p>
    <p>Non entrer√≤ nel dettaglio anche perch√® io ho solo grattato la superficie di questi argomenti, ma ecco come
      procedere come scheletro di base:</p>
    <p>1) Andiamo a modificare <code>src/index.js</code>: prima lavoravamo su <code>index_dev.js</code> ma Netlify andr√†
      a lavorare con i file di produzione, ed abbiamo istruito WebPack ad utilizzare il file <code>index.js</code> al
      posto di <code>index_dev.js</code> dentro a webpack.config.js <a href="#webpackconfigjs">QUI</a>; all&#39;interno
      di <code>index.js</code> andremo a sostituire la chiamata che prima facevamo in <code>index_dev.js</code> in
      questo modo:</p>
    <pre><code>`<span class="javascript"></span>``<span class="javascript">javascript
<span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">"axios"</span>

<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">callLambdaFunction</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// qui la magia: facciamo una chiamata ad una funzione che creeremo fra poco in un file a parte e che Netlify chiama dal proprio back-end in modo sicuro e privato quando necessario</span>
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.get(<span class="hljs-string">"/.netlify/functions/getPollution"</span>)

  <span class="hljs-built_in">console</span>.log(response) <span class="hljs-comment">// Facciamo ci√≤ che vogliamo coi dati ottenuti</span>
} 

callLambdaFunction()
</span>``<span class="javascript"></span>`
</code></pre>
    <p>2) Spieghiamo a Netlify dove trover√† le funzioni che ci servono: apriamo <code>netlify.toml</code> dalla cartella
      principale e scriviamo:</p>
    <pre><code>```toml
[build]
  functions = <span class="hljs-string">"./netlify/functions"</span>
```
</code></pre>
    <p>3) Nella cartella <code>netlify/functions</code> modifichiamo il file <code>getPollution.js</code> in questo
      modo:</p>
    <pre><code>`<span class="javascript"></span>``<span class="javascript">javascript
<span class="hljs-keyword">const</span> axios = <span class="hljs-built_in">require</span>(<span class="hljs-string">"axios"</span>)

exports.handler = <span class="hljs-keyword">async</span> event =&gt; {
  <span class="hljs-comment">// Pi√π tardi imposteremo una variabile d'ambiente interna a Netlify stesso, accessibile semplicemente cos√¨:</span>
  <span class="hljs-keyword">const</span> API_KEY =  process.env.API_KEY

  <span class="hljs-comment">// qui facciamo la chiamata alla API esattamente come la facevamo prima in index_dev.js</span>
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.get(<span class="hljs-comment">/* ... */</span>)

  <span class="hljs-comment">// da qui in gi√π la funzione fa da back-end: elaboriamo dei dati e li rimandiamo al front-end in formato JSON con uno statusCode 200, cio√® "successo".</span>
  <span class="hljs-keyword">const</span> pass = <span class="hljs-function">(<span class="hljs-params">body</span>) =&gt;</span> {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">statusCode</span>: <span class="hljs-number">200</span>,
      <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify(body)
    }
  }

  <span class="hljs-keyword">return</span> pass(response)
}
</span>``<span class="javascript"></span>`
</code></pre>
    <p>4) Generiamo i file da dare &quot;in pasto&quot; a Netlify con <code>npm run build</code></p>
    <p>5) Committiamo il nostro duro lavoro su GitHub da riga di comando:<br> <code>git push origin main</code> </p>
    <p>6) Entriamo su Netlify dopo esserci registrati ed iniziamo il deployment:</p>
    <pre><code>![<span class="hljs-string">Netlify New Site</span>](<span class="hljs-link">assets/netlify1.webp</span>)

![<span class="hljs-string">Netlify CD</span>](<span class="hljs-link">assets/netlify2.webp</span>)

![<span class="hljs-string">Netlify Choose Repo</span>](<span class="hljs-link">assets/netlify3.webp</span>)

<span class="hljs-strong">**prestare attenzione qui:**</span>
<span class="hljs-bullet">- </span>Scriviamo <span class="hljs-code">`build`</span> in "Publish directory" perch√® abbiamo istruito WebPack a piazzare in quella cartella i file per la produzione
<span class="hljs-bullet">- </span>Apriamo la sezione funzioni avanzate ed inseriamo finalmente la nostra API_KEY (mi raccomando il nome deve essere identico a quello che userete nei file .js!) nel sistema di Netlify. La funzione creata poco pi√π su andr√† a pescare la chiave da qui, in modo sicuro e privato.
<span class="hljs-bullet">- </span>Infine clicchiamo su Deploy site

![<span class="hljs-string">Netlify Configure Site</span>](<span class="hljs-link">assets/netlify4.webp</span>)
</code></pre>
    <p>7) Se tutto √® andato bene vedremo Netlify elaborare la richiesta e poi visualizzare questa schermata:
      <img src="assets/netlify5.webp" alt="Netlify Configure Site"></p>
    <pre><code>-<span class="ruby"> Possiamo vedere una preview del sito cliccando sull<span class="hljs-string">'indirizzo in verde
</span></span>-<span class="ruby"><span class="hljs-string"> Quell'</span>indirizzo generato casualmente pu√≤ essere cambiato da Deploy Settings &gt; Domain Management &gt; Custom domains &gt; Options &gt; Edit site name
</span>-<span class="ruby"> Ogni volta che viene committato un cambiamento su GitHub Netlify <span class="hljs-keyword">in</span> automatico crea una build aggiornata</span>
</code></pre>
    <p>8) Una volta finito tutto il progetto ricordatevi di andare nelle impostazioni di GitHub e renderlo pubblico!</p>
    <hr>
    <h2 id="that-s-all-folks">That&#39;s all folks</h2>
    <p>Questo √® lo scheletro dell&#39;applicazione, la configurazione di base necessaria per iniziare lo sviluppo
      dell&#39;app e come metterla online in sicurezza.</p>
    <p>Ora sta a voi capire come gestire le chiamate alla API, come strutturare l&#39;UI, che funzionalit√† inserire,
      error handling..</p>
    <p>Se volete vedere il mio codice lo trovate qui: <a
        href="https://github.com/fabio-mancin/city-pollution">city-pollution</a>; non ha una live preview perch√® quando
      ho fatto il progetto io non era richiesta ed ora non ho nessuna voglia di farla ;)</p>
    <p>Siete liberi di copiare il codice (dopotutto √® pubblico), ma ve lo sconsiglio nel modo pi√π assoluto non tanto
      perch√® ne sono geloso ma perch√® copiando vi dareste la zappa sui piedi: l&#39;unico modo per capire veramente √®
      FARE.</p>
    <p>Se avete bisogno di una mano per√≤ non esitate a contattarmi su <a href="https://discordapp.com/users/210117458147803136">Discord</a> o sui miei
      social che trovate nel mio sito <a href="https://www.fabiomancin.dev">fabiomancin.dev</a> (eddai lasciatemela fare
      un po&#39; di pubblicit√† a me stesso)</p>
    <p>Inizialmente avevo in mente una guida di poche righe, massimo una facciata, ma la situazione mi √® sfuggita di
      mano ed eccoci qui :smiley:</p>
    <p>Spero che ci√≤ che ho scritto sia utile, aspetto i vostri feedback üòâ</p>
    <p>Au revoir<br>Fabio</p>
  </main>

  <div class="decoration bottom">&lt;/body&gt;<br>&nbsp;&lt;/html&gt;</div>
  <footer>
    <span>Copyright ¬© 2021 Fabio Mancin</span>
  </footer>
  <script src="/static/scripts/scripts.min.js" async defer></script>
</body>

</html>